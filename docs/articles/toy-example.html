<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis of a Toy Example • plt</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of a Toy Example">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/toy-example.html">Analysis of a Toy Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysis of a Toy Example</h1>
            
      

      <div class="hidden name"><code>toy-example.Rmd</code></div>

    </div>

    
    
<p>This vignette reproduces the analysis of a toy example in Sections 5.2–5.7 of Bubenik and Dłotko (2017).<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">plt</span><span class="op">)</span></span></code></pre></div>
<p>The purpose of this example is to illustrate the Persistence Landscapes Toolbox for summarizing and discriminating among point cloud data based on their persistent homology. The toy data comprise several point clouds sampled from unions of pairwise tangent unit circles; see the example after the sampler below (c.f. Section 5.2):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sample `50 * n` points from `n` concatenated circles with uniform noise</span></span>
<span><span class="va">sample_tangent_circles</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># bind rows from several samples</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="va">n</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># sample from the unit circle</span></span>
<span>    <span class="fu">tdaunif</span><span class="fu">::</span><span class="fu"><a href="https://tdaverse.github.io/tdaunif/reference/circles.html" class="external-link">sample_circle</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50L</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># shift this circle `m` units rightward</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">m</span>, <span class="fl">0</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">50L</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="co"># add uniform noise</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50L</span> <span class="op">*</span> <span class="fl">2L</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">0.15</span>, max <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># illustrate with a 5-circle sequence</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fu">sample_tangent_circles</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span>, pch <span class="op">=</span> <span class="st">"+"</span>, col <span class="op">=</span> <span class="st">"red"</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="toy-example_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>Here we generate all <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>*</mo><mn>11</mn><mo>=</mo><mn>55</mn></mrow><annotation encoding="application/x-tex">5 * 11 = 55</annotation></semantics></math> samples and store their degree-1 persistence landscapes. We include a scale factor that recovers landscapes at the same scale as those reported in the paper:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define scale factor</span></span>
<span><span class="va">sf</span> <span class="op">&lt;-</span> <span class="fl">55</span></span>
<span><span class="co"># initialize list</span></span>
<span><span class="va">toy_pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fl">5L</span><span class="op">)</span></span>
<span><span class="co"># populate each position in the list</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">toy_pl</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># initialize sub-list</span></span>
<span>  <span class="va">toy_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fl">11L</span><span class="op">)</span></span>
<span>  <span class="co"># draw 11 samples</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">11L</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">toy_data</span> <span class="op">&lt;-</span> <span class="fu">sample_tangent_circles</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>    <span class="co"># scale data by scale factor</span></span>
<span>    <span class="va">toy_data</span><span class="op">[</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">toy_data</span><span class="op">[</span>, <span class="op">]</span> <span class="op">*</span> <span class="va">sf</span></span>
<span>    <span class="co"># calculate persistent homology, up to the diameter of the subspace</span></span>
<span>    <span class="va">ph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span>
<span>      <span class="fu">ripserr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ripserr/man/vietoris_rips.html" class="external-link">vietoris_rips</a></span><span class="op">(</span><span class="va">toy_data</span>, dim <span class="op">=</span> <span class="fl">1</span>, threshold <span class="op">=</span> <span class="va">n</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">sf</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="co"># format as persistence data</span></span>
<span>    <span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_persistence.html">as_persistence</a></span><span class="op">(</span><span class="va">ph</span><span class="op">)</span></span>
<span>    <span class="co"># construct degree-1 persistence landscape</span></span>
<span>    <span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pl_new.html">pl_new</a></span><span class="op">(</span><span class="va">pd</span>, degree <span class="op">=</span> <span class="fl">1L</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="co"># store the landscape</span></span>
<span>    <span class="va">toy_n</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pl</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">toy_pl</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">toy_n</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Each landscape contains as many significant levels as circles made up the sample space. In the plots below, tick marks are omitted to make more space for the landscapes themselves:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11L</span>, <span class="fl">5L</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">toy_pl</span><span class="op">)</span><span class="op">)</span> <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">toy_pl</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">toy_pl</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="toy-example_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>The commonalities of the samples from each space can be revealed by taking their mean landscapes (c.f. Section 5.4):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate means</span></span>
<span><span class="va">toy_pl_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">toy_pl</span>, <span class="va">pl_mean</span><span class="op">)</span></span>
<span><span class="co"># plot  means</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">5L</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">toy_pl_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">toy_pl_mean</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="toy-example_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>Below we compute the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>-, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>-, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>∞</mi><annotation encoding="application/x-tex">\infty</annotation></semantics></math>-norms of these mean landscapes (c.f. Section 5.5):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># norms to calculate</span></span>
<span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co"># initialize matrix</span></span>
<span><span class="va">toy_pl_norms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA_real_</span>, nrow <span class="op">=</span> <span class="fl">5L</span>, ncol <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">toy_pl_norms</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span>, <span class="st">"-circle"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">toy_pl_norms</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p = "</span>, <span class="va">ps</span><span class="op">)</span></span>
<span><span class="co"># populate matrix</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">toy_pl_mean</span><span class="op">)</span><span class="op">)</span> <span class="kw">for</span> <span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># calculate norm</span></span>
<span>  <span class="va">toy_pl_norms</span><span class="op">[</span><span class="va">n</span>, <span class="va">p</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysis.html">pl_norm</a></span><span class="op">(</span><span class="va">toy_pl_mean</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span>, <span class="va">ps</span><span class="op">[[</span><span class="va">p</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># print matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">toy_pl_norms</span><span class="op">)</span></span>
<span><span class="co">#&gt;              p = 1    p = 2  p = Inf</span></span>
<span><span class="co">#&gt; 1-circle  777.3095 118.5246 26.02017</span></span>
<span><span class="co">#&gt; 2-circle 1783.4118 185.7788 29.48225</span></span>
<span><span class="co">#&gt; 3-circle 2430.9508 210.5853 29.24994</span></span>
<span><span class="co">#&gt; 4-circle 3343.0838 251.6085 31.01226</span></span>
<span><span class="co">#&gt; 5-circle 4081.0200 277.3163 30.87295</span></span></code></pre></div>
<p>Below we compute the pairwise <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>-distances between the mean landscapes (c.f. Section 5.6):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute distance matrix</span></span>
<span><span class="fu"><a href="../reference/analysis.html">pl_dist</a></span><span class="op">(</span><span class="va">toy_pl_mean</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1]      [,2]      [,3]      [,4]      [,5]</span></span>
<span><span class="co">#&gt; [1,]   0.0000 121.66729 156.72068 205.81555 235.31593</span></span>
<span><span class="co">#&gt; [2,] 121.6673   0.00000  95.45027 150.94825 187.10785</span></span>
<span><span class="co">#&gt; [3,] 156.7207  95.45027   0.00000  95.81676 143.13606</span></span>
<span><span class="co">#&gt; [4,] 205.8155 150.94825  95.81676   0.00000  88.71722</span></span>
<span><span class="co">#&gt; [5,] 235.3159 187.10785 143.13606  88.71722   0.00000</span></span></code></pre></div>
<p>Section 5.7 reports that permutation tests between the sample landscapes from different numbers <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> of circles all obtained p-values near zero, successfully detecting the differences between the samples. Below we report two permutation tests, between the samples <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n=1</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n=2</annotation></semantics></math> and between the samples <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">n=4</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">n=5</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compare 1-circle and 2-circle samples</span></span>
<span><span class="fu"><a href="../reference/inference.html">pl_perm_test</a></span><span class="op">(</span><span class="va">toy_pl</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span>, <span class="va">toy_pl</span><span class="op">[[</span><span class="fl">2L</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  permutation test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: true distance between mean landscapes is greater than 0</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; distance between mean landscapes </span></span>
<span><span class="co">#&gt;                         121.6673</span></span>
<span><span class="co"># compare 4-circle and 5-circle samples</span></span>
<span><span class="fu"><a href="../reference/inference.html">pl_perm_test</a></span><span class="op">(</span><span class="va">toy_pl</span><span class="op">[[</span><span class="fl">4L</span><span class="op">]</span><span class="op">]</span>, <span class="va">toy_pl</span><span class="op">[[</span><span class="fl">5L</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  permutation test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: true distance between mean landscapes is greater than 0</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; distance between mean landscapes </span></span>
<span><span class="co">#&gt;                         88.71722</span></span></code></pre></div>
<p>To test the specificity, rather than the sensitivity, of the permutation test, below we generate additional, smaller samples from the 1- and 5-circle spaces and perform permutation tests between them and their original counterparts from the same spaces:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># draw a new 1-circle sample</span></span>
<span><span class="va">new_pl_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">6L</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">toy_data</span> <span class="op">&lt;-</span> <span class="fu">sample_tangent_circles</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">toy_data</span><span class="op">[</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">toy_data</span><span class="op">[</span>, <span class="op">]</span> <span class="op">*</span> <span class="va">sf</span></span>
<span>  <span class="va">ph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span>
<span>    <span class="fu">ripserr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ripserr/man/vietoris_rips.html" class="external-link">vietoris_rips</a></span><span class="op">(</span><span class="va">toy_data</span>, dim <span class="op">=</span> <span class="fl">1</span>, threshold <span class="op">=</span> <span class="fl">1</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">sf</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_persistence.html">as_persistence</a></span><span class="op">(</span><span class="va">ph</span><span class="op">)</span></span>
<span>  <span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pl_new.html">pl_new</a></span><span class="op">(</span><span class="va">pd</span>, degree <span class="op">=</span> <span class="fl">1L</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">new_pl_1</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pl</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># compare old &amp; new 1-circle samples</span></span>
<span><span class="fu"><a href="../reference/inference.html">pl_perm_test</a></span><span class="op">(</span><span class="va">toy_pl</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span>, <span class="va">new_pl_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  permutation test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; p-value = 0.389</span></span>
<span><span class="co">#&gt; alternative hypothesis: true distance between mean landscapes is greater than 0</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; distance between mean landscapes </span></span>
<span><span class="co">#&gt;                          13.6971</span></span>
<span></span>
<span><span class="co"># draw a new 5-circle sample</span></span>
<span><span class="va">new_pl_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">6L</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">toy_data</span> <span class="op">&lt;-</span> <span class="fu">sample_tangent_circles</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="va">toy_data</span><span class="op">[</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">toy_data</span><span class="op">[</span>, <span class="op">]</span> <span class="op">*</span> <span class="va">sf</span></span>
<span>  <span class="va">ph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span>
<span>    <span class="fu">ripserr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ripserr/man/vietoris_rips.html" class="external-link">vietoris_rips</a></span><span class="op">(</span><span class="va">toy_data</span>, dim <span class="op">=</span> <span class="fl">1</span>, threshold <span class="op">=</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">sf</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_persistence.html">as_persistence</a></span><span class="op">(</span><span class="va">ph</span><span class="op">)</span></span>
<span>  <span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pl_new.html">pl_new</a></span><span class="op">(</span><span class="va">pd</span>, degree <span class="op">=</span> <span class="fl">1L</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">new_pl_5</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pl</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># compare old &amp; new 5-circle samples</span></span>
<span><span class="fu"><a href="../reference/inference.html">pl_perm_test</a></span><span class="op">(</span><span class="va">toy_pl</span><span class="op">[[</span><span class="fl">5L</span><span class="op">]</span><span class="op">]</span>, <span class="va">new_pl_5</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  permutation test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; p-value = 0.454</span></span>
<span><span class="co">#&gt; alternative hypothesis: true distance between mean landscapes is greater than 0</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; distance between mean landscapes </span></span>
<span><span class="co">#&gt;                         22.58901</span></span></code></pre></div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Bubenik P &amp; Dłotko P (2017) “A persistence landscapes toolbox for topological statistics”. <em>Journal of Symbolic Computation</em> <strong>78</strong>(1):91–114. <a href="https://www.sciencedirect.com/science/article/pii/S0747717116300104" class="external-link uri">https://www.sciencedirect.com/science/article/pii/S0747717116300104</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jason Cory Brunson, Jose Bouza, Paweł Dłotko.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
