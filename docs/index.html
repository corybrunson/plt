<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R Interface to the Persistence Landscapes Toolbox • plt</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="R Interface to the Persistence Landscapes Toolbox">
<meta property="og:description" content="Persistence data (often equated with persistence diagrams) are difficult to couple with statistical tools and machine learning approaches. Bubenik (2015) &lt;arXiv:1207.6437&gt; introduced persistence landscapes to address this problem by encoding persistence data as functions with a Hilbert space structure. As such, they admit linear operations, an inner product, and desirable statistical properties like a central limit theorem. Bubenik and Dłotko (2017) &lt;doi:10.1016/j.jsc.2016.03.009&gt; developed the Persistence Landscapes Toolbox to facilitate computational work with persistence landscapes. These included calculations of distance, a null hypothesis testing procedure, and a support vector machine classifier. Core functionality was exported to R in the tda-tools package by Bouza, from which this package is adapted.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">plt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/overview.html">Exploratory and Predictive Analysis</a>
    </li>
    <li>
      <a href="articles/toy-example.html">Analysis of a Toy Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="plt">plt<a class="anchor" aria-label="anchor" href="#plt"></a>
</h1></div>
<p>Persistence landscapes are a vectorization of persistence data/diagrams that have useful statistical properties including linearity and an inner product.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> This is an R package interface to a C++ library to efficienctly compute and calculate with persistence landscapes.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Until the package is on CRAN, use <strong>pak</strong> to install the package from the GitHub repository as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"corybrunson/plt"</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively—and especially if you want to contribute—you can clone or download the code repository and, from within the directory, install the package from source:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You should now be able to load the package normally from an R session:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">plt</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quickstart-guide">Quickstart Guide<a class="anchor" aria-label="anchor" href="#quickstart-guide"></a>
</h2>
<p>The <strong>plt</strong> package supports various operations involving persistence landscapes:</p>
<ul>
<li>Compute persistence landscapes from persistence data</li>
<li>Plot persistence landscapes</li>
<li>Perform Hilbert space operations (scaling, addition, inner product) plus some additional queries and transformations (extremal values, absolute value, integration) on persistence landscapes</li>
<li>Conduct hypothesis tests on samples of persistence landscapes</li>
<li>Vectorize persistence landscapes for other purposes including machine learning</li>
</ul>
<p>Examples and tests in <strong>plt</strong> rely on other packages to simulate data and to compute persistence diagrams from data:</p>
<ul>
<li>
<strong>tdaunif</strong> provides functions to sample uniformly from various immersed manifolds.</li>
<li>
<strong>ripserr</strong> and <strong>TDA</strong> provide functions to compute persistence data from point clouds and distance matrices.</li>
</ul>
<p><strong>plt</strong> introduces the ‘Rcpp_PersistenceLandscape’ S4 class, which is exposed using <strong>Rcpp</strong> from the underlying ‘PersistenceLandscape’ C++ class. Instances of this class can be created using <code>new()</code> but the recommended way is to use <code><a href="reference/pl_new.html">pl_new()</a></code>. This function accepts either a single matrix of persistence data or a specially formatted list with the class <code>'persistence_diagram"</code>. The <code>$pairs</code> entry of the list is itself a list, of a 2-column matrix of persistence pairs for each homological degree from 0 (<code>$pairs[[1]]</code>) to the maximum degree calculated. The generic converter <code><a href="reference/as_persistence.html">as_persistence()</a></code> includes methods for outputs from <code><a href="https://rdrr.io/pkg/ripserr/man/vietoris_rips.html" class="external-link">ripserr::vietoris_rips()</a></code> and from <code>TDA::*Diag()</code>; it operates under the hood of <code><a href="reference/pl_new.html">pl_new()</a></code>, but we invoke it explicitly here for illustration.</p>
<div class="section level3">
<h3 id="calculation">Calculation<a class="anchor" aria-label="anchor" href="#calculation"></a>
</h3>
<p>To begin an illustration, we noisily sample 60 points from a figure eight and compute the persistence diagram of the point cloud:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">513611L</span><span class="op">)</span></span>
<span><span class="va">pc</span> <span class="op">&lt;-</span> <span class="fu">tdaunif</span><span class="fu">::</span><span class="fu"><a href="https://tdaverse.github.io/tdaunif/reference/lemniscates.html" class="external-link">sample_lemniscate_gerono</a></span><span class="op">(</span><span class="fl">60</span>, sd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pc</span>, asp <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">16L</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-5-1.png"><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu">ripserr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ripserr/man/vietoris_rips.html" class="external-link">vietoris_rips</a></span><span class="op">(</span><span class="va">pc</span>, dim <span class="op">=</span> <span class="fl">1</span>, threshold <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span></span>
<span><span class="co">#&gt; PHom object containing persistence data for 63 features.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contains:</span></span>
<span><span class="co">#&gt; * 59 0-dim features</span></span>
<span><span class="co">#&gt; * 4 1-dim features</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Radius/diameter: min = 0; max = 0.63582.</span></span></code></pre></div>
<p>We the convert the persistence data to the preferred persistence diagram format and inspect some of its features:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_persistence.html">as_persistence</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'persistence' data computed up to degree 1:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * 0-degree features: 59</span></span>
<span><span class="co">#&gt; * 1-degree features:  4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pd</span><span class="op">$</span><span class="va">pairs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,]    0 0.01918952</span></span>
<span><span class="co">#&gt; [2,]    0 0.01947548</span></span>
<span><span class="co">#&gt; [3,]    0 0.02604350</span></span>
<span><span class="co">#&gt; [4,]    0 0.04218479</span></span>
<span><span class="co">#&gt; [5,]    0 0.04542467</span></span>
<span><span class="co">#&gt; [6,]    0 0.05941691</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pd</span><span class="op">$</span><span class="va">pairs</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.4809292 0.6358225</span></span>
<span><span class="co">#&gt; [2,] 0.3016234 0.6075172</span></span>
<span><span class="co">#&gt; [3,] 0.2504500 0.2727915</span></span>
<span><span class="co">#&gt; [4,] 0.2251884 0.2300871</span></span></code></pre></div>
<p>This allows us to compute a persistence landscape—in this case, for the 1-dimensional features. Here we compute the landscape exactly, which can be cost-prohibitive for larger persistence data, and print its summary:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pl_new.html">pl_new</a></span><span class="op">(</span><span class="va">pd</span>, degree <span class="op">=</span> <span class="fl">1</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pl1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Persistence landscape (exact format) of 2 levels over (0,0.636)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pl1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Internal representation:  exact </span></span>
<span><span class="co">#&gt; Number of levels:  2 </span></span>
<span><span class="co">#&gt; Representation limits: ( 0.22519 , 0.6358 ) </span></span>
<span><span class="co">#&gt; Landscape range: ( 0 , 0.15295 ) </span></span>
<span><span class="co">#&gt; Magnitude:  0.0026959 </span></span>
<span><span class="co">#&gt; Integral:   0.029522</span></span></code></pre></div>
<p>Some advanced concepts like the magnitude of a landscape will be explained below.</p>
</div>
<div class="section level3">
<h3 id="class">Class<a class="anchor" aria-label="anchor" href="#class"></a>
</h3>
<p>The object <code>pl1</code> is not an array, but rather an object that encapsulates both the data that encode a landscape and several basic operations that can be performed on it. This allows us to work with persistence landscapes without worrying about pre-processing their representations. At any point, the underlying encoding of the landscape can be extracted using <code>$getInternal()</code>, which in the case of an exactly calculated landscape returns a list of 2-column matrices, each matrix containing coordinates that define one level of the landscape as a piecewise linear function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pl1</span><span class="op">$</span><span class="fu">getInternal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pl1</span><span class="op">$</span><span class="fu">getInternal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;            [,1]        [,2]</span></span>
<span><span class="co">#&gt;  [1,]      -Inf 0.000000000</span></span>
<span><span class="co">#&gt;  [2,] 0.2251884 0.000000000</span></span>
<span><span class="co">#&gt;  [3,] 0.2276378 0.002449358</span></span>
<span><span class="co">#&gt;  [4,] 0.2300871 0.000000000</span></span>
<span><span class="co">#&gt;  [5,] 0.2504500 0.000000000</span></span>
<span><span class="co">#&gt;  [6,] 0.2616207 0.011170764</span></span>
<span><span class="co">#&gt;  [7,] 0.2727915 0.000000000</span></span>
<span><span class="co">#&gt;  [8,] 0.3016234 0.000000000</span></span>
<span><span class="co">#&gt;  [9,] 0.4545703 0.152946885</span></span>
<span><span class="co">#&gt; [10,] 0.5442232 0.063293964</span></span>
<span><span class="co">#&gt; [11,] 0.5583759 0.077446647</span></span>
<span><span class="co">#&gt; [12,] 0.6358225 0.000000000</span></span>
<span><span class="co">#&gt; [13,]       Inf 0.000000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;           [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,]      -Inf 0.00000000</span></span>
<span><span class="co">#&gt; [2,] 0.4809292 0.00000000</span></span>
<span><span class="co">#&gt; [3,] 0.5442232 0.06329396</span></span>
<span><span class="co">#&gt; [4,] 0.6075172 0.00000000</span></span>
<span><span class="co">#&gt; [5,]       Inf 0.00000000</span></span></code></pre></div>
<p>An alternative, approximate construction computes the value of each level of the landscape at each point on a 1-dimensional grid, ranging from <code>xmin</code> to <code>xmax</code> at increments of <code>xby</code>. A landscape constructed using a discrete approximation is stored as a 3-dimensional array of dimensions (levels, values, 2), with one level per feature (some of which may be trivial) and one value per grid point, stored as <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math> pairs along the third dimension.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_ran</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pl_new.html">pl_support</a></span><span class="op">(</span><span class="va">pl1</span><span class="op">)</span></span>
<span><span class="va">pl1d</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pl_new.html">pl_new</a></span><span class="op">(</span><span class="va">pd</span>, degree <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               xmin <span class="op">=</span> <span class="va">b_ran</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span>, xmax <span class="op">=</span> <span class="va">b_ran</span><span class="op">[[</span><span class="fl">2L</span><span class="op">]</span><span class="op">]</span>, xby <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pl1d</span><span class="op">$</span><span class="fu">getInternal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  4 10  2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pl1d</span><span class="op">$</span><span class="fu">getInternal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]</span></span>
<span><span class="co">#&gt; [1,] 0.2251884 0.2751884 0.3251884 0.3751884 0.4251884 0.4751884 0.5251884</span></span>
<span><span class="co">#&gt; [2,] 0.2251884 0.2751884 0.3251884 0.3751884 0.4251884 0.4751884 0.5251884</span></span>
<span><span class="co">#&gt; [3,] 0.2251884 0.2751884 0.3251884 0.3751884 0.4251884 0.4751884 0.5251884</span></span>
<span><span class="co">#&gt; [4,] 0.2251884 0.2751884 0.3251884 0.3751884 0.4251884 0.4751884 0.5251884</span></span>
<span><span class="co">#&gt;           [,8]      [,9]     [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.5751884 0.6251884 0.6751884</span></span>
<span><span class="co">#&gt; [2,] 0.5751884 0.6251884 0.6751884</span></span>
<span><span class="co">#&gt; [3,] 0.5751884 0.6251884 0.6751884</span></span>
<span><span class="co">#&gt; [4,] 0.5751884 0.6251884 0.6751884</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2]       [,3]       [,4]     [,5]      [,6]       [,7]       [,8]</span></span>
<span><span class="co">#&gt; [1,]    0    0 0.02356502 0.07356502 0.123565 0.1323288 0.08232875 0.06063412</span></span>
<span><span class="co">#&gt; [2,]    0    0 0.00000000 0.00000000 0.000000 0.0000000 0.04425917 0.03232875</span></span>
<span><span class="co">#&gt; [3,]    0    0 0.00000000 0.00000000 0.000000 0.0000000 0.00000000 0.00000000</span></span>
<span><span class="co">#&gt; [4,]    0    0 0.00000000 0.00000000 0.000000 0.0000000 0.00000000 0.00000000</span></span>
<span><span class="co">#&gt;            [,9] [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.01063412     0</span></span>
<span><span class="co">#&gt; [2,] 0.00000000     0</span></span>
<span><span class="co">#&gt; [3,] 0.00000000     0</span></span>
<span><span class="co">#&gt; [4,] 0.00000000     0</span></span></code></pre></div>
<p>Exactly computed landscapes can be converted to discrete landscape objects, but the other direction is not well-defined. Below, we view a portion of the discretized exact landscape, using the default bounds and resolution given to <code>pl1</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># default conversion to discrete uses `xby = 0.001`</span></span>
<span><span class="va">pl1_</span> <span class="op">&lt;-</span> <span class="va">pl1</span><span class="op">$</span><span class="fu">discretize</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pl1_</span><span class="op">$</span><span class="fu">getInternal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   2 636   2</span></span>
<span><span class="co"># print first 12 x-coordinates</span></span>
<span><span class="va">pl1_</span><span class="op">$</span><span class="fu">getInternal</span><span class="op">(</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">230L</span>, <span class="fl">270L</span><span class="op">)</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="co">#&gt; , , 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       [,1] [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]</span></span>
<span><span class="co">#&gt; [1,] 0.229 0.23 0.231 0.232 0.233 0.234 0.235 0.236 0.237 0.238 0.239  0.24</span></span>
<span><span class="co">#&gt; [2,] 0.229 0.23 0.231 0.232 0.233 0.234 0.235 0.236 0.237 0.238 0.239  0.24</span></span>
<span><span class="co">#&gt;      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]</span></span>
<span><span class="co">#&gt; [1,] 0.241 0.242 0.243 0.244 0.245 0.246 0.247 0.248 0.249  0.25 0.251 0.252</span></span>
<span><span class="co">#&gt; [2,] 0.241 0.242 0.243 0.244 0.245 0.246 0.247 0.248 0.249  0.25 0.251 0.252</span></span>
<span><span class="co">#&gt;      [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36]</span></span>
<span><span class="co">#&gt; [1,] 0.253 0.254 0.255 0.256 0.257 0.258 0.259  0.26 0.261 0.262 0.263 0.264</span></span>
<span><span class="co">#&gt; [2,] 0.253 0.254 0.255 0.256 0.257 0.258 0.259  0.26 0.261 0.262 0.263 0.264</span></span>
<span><span class="co">#&gt;      [,37] [,38] [,39] [,40] [,41]</span></span>
<span><span class="co">#&gt; [1,] 0.265 0.266 0.267 0.268 0.269</span></span>
<span><span class="co">#&gt; [2,] 0.265 0.266 0.267 0.268 0.269</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              [,1]         [,2]         [,3]         [,4]         [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.0006539916 5.241935e-05 4.985605e-05 4.729276e-05 4.472946e-05</span></span>
<span><span class="co">#&gt; [2,] 0.0000000000 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span></span>
<span><span class="co">#&gt;              [,6]         [,7]         [,8]         [,9]        [,10]</span></span>
<span><span class="co">#&gt; [1,] 4.216616e-05 3.960287e-05 3.703957e-05 3.447627e-05 3.191297e-05</span></span>
<span><span class="co">#&gt; [2,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span></span>
<span><span class="co">#&gt;             [,11]        [,12]        [,13]        [,14]        [,15]</span></span>
<span><span class="co">#&gt; [1,] 2.934968e-05 2.678638e-05 2.422308e-05 2.165979e-05 1.909649e-05</span></span>
<span><span class="co">#&gt; [2,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span></span>
<span><span class="co">#&gt;             [,16]        [,17]       [,18]      [,19]        [,20]        [,21]</span></span>
<span><span class="co">#&gt; [1,] 1.653319e-05 1.396989e-05 1.14066e-05 8.8433e-06 6.280002e-06 3.716705e-06</span></span>
<span><span class="co">#&gt; [2,] 0.000000e+00 0.000000e+00 0.00000e+00 0.0000e+00 0.000000e+00 0.000000e+00</span></span>
<span><span class="co">#&gt;             [,22]        [,23]       [,24]       [,25]       [,26]      [,27]</span></span>
<span><span class="co">#&gt; [1,] 1.153408e-06 0.0009623328 0.001923512 0.002884692 0.003845871 0.00480705</span></span>
<span><span class="co">#&gt; [2,] 0.000000e+00 0.0000000000 0.000000000 0.000000000 0.000000000 0.00000000</span></span>
<span><span class="co">#&gt;           [,28]       [,29]       [,30]       [,31]       [,32]      [,33]</span></span>
<span><span class="co">#&gt; [1,] 0.00576823 0.006729409 0.007690589 0.008651768 0.009612947 0.01057413</span></span>
<span><span class="co">#&gt; [2,] 0.00000000 0.000000000 0.000000000 0.000000000 0.000000000 0.00000000</span></span>
<span><span class="co">#&gt;            [,34]      [,35]       [,36]       [,37]       [,38]       [,39]</span></span>
<span><span class="co">#&gt; [1,] 0.009677368 0.00878061 0.007883851 0.006987093 0.006090334 0.005193576</span></span>
<span><span class="co">#&gt; [2,] 0.000000000 0.00000000 0.000000000 0.000000000 0.000000000 0.000000000</span></span>
<span><span class="co">#&gt;            [,40]       [,41]</span></span>
<span><span class="co">#&gt; [1,] 0.004296817 0.003400059</span></span>
<span><span class="co">#&gt; [2,] 0.000000000 0.000000000</span></span></code></pre></div>
<p>We can also specify the bounds and the resolution of the discretization:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pl_new.html">pl_delimit</a></span><span class="op">(</span><span class="va">pl1</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">1</span>, xby <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">pl1_</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pl_new.html">pl_discretize</a></span><span class="op">(</span><span class="va">pl1</span><span class="op">)</span></span>
<span><span class="va">pl1_</span><span class="op">$</span><span class="fu">getInternal</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11]</span></span>
<span><span class="co">#&gt; [1,]    0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8   0.9     1</span></span>
<span><span class="co">#&gt; [2,]    0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8   0.9     1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]       [,4]      [,5]       [,6]        [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0 0.09837659 0.1075172 0.03582254 0.000000000    0    0     0</span></span>
<span><span class="co">#&gt; [2,]    0    0    0 0.00000000 0.0000000 0.04388611 0.003068344    0    0     0</span></span>
<span><span class="co">#&gt;      [,11]</span></span>
<span><span class="co">#&gt; [1,]     0</span></span>
<span><span class="co">#&gt; [2,]     0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h3>
<p><strong>plt</strong> provides a <code><a href="reference/plot.html">plot()</a></code> method for the ‘Rcpp_PersistenceLandscape’ class. It uses <strong>grDevices</strong> to build color palettes, and as such its default palette is viridis; but the user may supply the name of a recognized palette or a sequence of colors between which to interpolate:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_levs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="reference/pl_new.html">pl_num_levels</a></span><span class="op">(</span><span class="va">pl1</span><span class="op">)</span>, <span class="fu"><a href="reference/pl_new.html">pl_num_levels</a></span><span class="op">(</span><span class="va">pl1d</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">1L</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pl1</span>, palette <span class="op">=</span> <span class="st">"terrain"</span>, n_levels <span class="op">=</span> <span class="va">n_levs</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pl1d</span>, palette <span class="op">=</span> <span class="st">"terrain"</span>, n_levels <span class="op">=</span> <span class="va">n_levs</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-12-1.png"><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hilbert-space-operations">Hilbert Space Operations<a class="anchor" aria-label="anchor" href="#hilbert-space-operations"></a>
</h3>
<p>To illustrate these features, we first generate a companion data set:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a new landscape and its discretization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">772888L</span><span class="op">)</span></span>
<span><span class="va">pc2</span> <span class="op">&lt;-</span> <span class="fu">tdaunif</span><span class="fu">::</span><span class="fu"><a href="https://tdaverse.github.io/tdaunif/reference/circles.html" class="external-link">sample_circle</a></span><span class="op">(</span><span class="fl">60</span>, sd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">pd2</span> <span class="op">&lt;-</span> <span class="fu">ripserr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ripserr/man/vietoris_rips.html" class="external-link">vietoris_rips</a></span><span class="op">(</span><span class="va">pc2</span>, dim <span class="op">=</span> <span class="fl">1</span>, threshold <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">pl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pl_new.html">pl_new</a></span><span class="op">(</span><span class="va">pd2</span>, degree <span class="op">=</span> <span class="fl">1</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pl_new.html">pl_delimit</a></span><span class="op">(</span><span class="va">pl2</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">2</span>, xby <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">pl2_</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pl_new.html">pl_discretize</a></span><span class="op">(</span><span class="va">pl2</span><span class="op">)</span></span></code></pre></div>
<p>Several infix operators have been taught to work in the natural way with landscapes, so that users can explore vector space operations and inner products more conveniently:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">2L</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># vector space operations on exact landscapes</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pl1</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pl2</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pl1</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">pl2</span><span class="op">)</span></span>
<span><span class="co"># vector space operations on discrete landscapes</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pl1_</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="op">-</span><span class="va">pl2_</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pl1_</span> <span class="op">-</span> <span class="va">pl2_</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-14-1.png"><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># inner products of exact and discrete landscapes</span></span>
<span><span class="va">pl1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">pl2</span></span>
<span><span class="co">#&gt; [1] 0.005336876</span></span>
<span><span class="va">pl1_</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">pl2_</span></span>
<span><span class="co">#&gt; [1] 0.004917171</span></span>
<span><span class="va">pl1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">pl2_</span></span>
<span><span class="co">#&gt; [1] 0.004917171</span></span></code></pre></div>
<p>(Note that the landscapes are automatically delimited to a compatible domain.)</p>
</div>
<div class="section level3">
<h3 id="calculus">Calculus<a class="anchor" aria-label="anchor" href="#calculus"></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method above reported the magnitude and the integral of the persistence landscape <code>pl1</code>. The magnitude is the inner product of <code>pl1</code> with itself: <code>pl1 %*% pl1 = 0.0026959</code>. Meanwhile, the integral is the (signed) area under the curve, itself also a linear operator:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/analysis.html">pl_integrate</a></span><span class="op">(</span><span class="va">pl1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.02952152</span></span>
<span><span class="fu"><a href="reference/analysis.html">pl_integrate</a></span><span class="op">(</span><span class="va">pl2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.07295263</span></span>
<span><span class="co"># 1-integral obeys linearity</span></span>
<span><span class="fu"><a href="reference/analysis.html">pl_integrate</a></span><span class="op">(</span><span class="va">pl1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">-</span> <span class="fu"><a href="reference/analysis.html">pl_integrate</a></span><span class="op">(</span><span class="va">pl2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.01390959</span></span>
<span><span class="fu"><a href="reference/analysis.html">pl_integrate</a></span><span class="op">(</span><span class="va">pl1</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">-</span> <span class="va">pl2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.01390959</span></span></code></pre></div>
<p>The distance between two landscapes is defined in terms of the integral of their absolute difference for finite norms and the maximum pointwise distance for the infinite norm. Note that, because <code><a href="reference/analysis.html">pl_integrate()</a></code> defaults to the 1-norm and <code><a href="reference/analysis.html">pl_distance()</a></code> defaults to the 2-norm, we must be careful when comparing their results:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using the 1-norm</span></span>
<span><span class="fu"><a href="reference/analysis.html">pl_integrate</a></span><span class="op">(</span><span class="fu"><a href="reference/arithmetic.html">pl_abs</a></span><span class="op">(</span><span class="va">pl1</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">-</span> <span class="va">pl2</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.03560593</span></span>
<span><span class="fu"><a href="reference/analysis.html">pl_distance</a></span><span class="op">(</span><span class="va">pl1</span> <span class="op">*</span> <span class="fl">2</span>, <span class="va">pl2</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.03560593</span></span>
<span></span>
<span><span class="co"># using the 2-norm</span></span>
<span><span class="fu"><a href="reference/analysis.html">pl_integrate</a></span><span class="op">(</span><span class="fu"><a href="reference/arithmetic.html">pl_abs</a></span><span class="op">(</span><span class="va">pl1</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">-</span> <span class="va">pl2</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">^</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.05041889</span></span>
<span><span class="fu"><a href="reference/analysis.html">pl_distance</a></span><span class="op">(</span><span class="va">pl1</span> <span class="op">*</span> <span class="fl">2</span>, <span class="va">pl2</span>, p <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.05041889</span></span>
<span></span>
<span><span class="co"># using the infinity norm</span></span>
<span><span class="fu"><a href="reference/arithmetic.html">pl_vmax</a></span><span class="op">(</span><span class="fu"><a href="reference/arithmetic.html">pl_abs</a></span><span class="op">(</span><span class="va">pl1</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">-</span> <span class="va">pl2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1178478 0.1265879</span></span>
<span><span class="fu"><a href="reference/analysis.html">pl_distance</a></span><span class="op">(</span><span class="va">pl1</span> <span class="op">*</span> <span class="fl">2</span>, <span class="va">pl2</span>, p <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1265879</span></span></code></pre></div>
<p>The norm of a persistence landscape is then defined as its distance from the null landscape that is constant at zero. (The following code chunk is not evaluated, pending a debug of <code><a href="reference/pl_new.html">pl_new()</a></code> when fed an empty matrix.)</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># null landscape</span></span>
<span><span class="va">pd0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">0L</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="fl">0L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># FIXME: Enable landscape construction from empty persistence data.</span></span>
<span><span class="va">pl0</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pl_new.html">pl_new</a></span><span class="op">(</span><span class="va">pd0</span>, degree <span class="op">=</span> <span class="fl">1</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/analysis.html">pl_distance</a></span><span class="op">(</span><span class="va">pl1</span>, <span class="va">pl0</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/analysis.html">pl_norm</a></span><span class="op">(</span><span class="va">pl1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="statistical-analysis">Statistical Analysis<a class="anchor" aria-label="anchor" href="#statistical-analysis"></a>
</h3>
<p>Finally, <strong>plt</strong> implements the two hypothesis tests described in the original paper. To illustrate, we first generate lists of landscapes for samples from two spaces:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># samples of landscapes from lemniscates</span></span>
<span><span class="va">pl1s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">6</span>, <span class="op">{</span></span>
<span>  <span class="va">pc</span> <span class="op">&lt;-</span> <span class="fu">tdaunif</span><span class="fu">::</span><span class="fu"><a href="https://tdaverse.github.io/tdaunif/reference/lemniscates.html" class="external-link">sample_lemniscate_gerono</a></span><span class="op">(</span><span class="fl">60</span>, sd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></span>
<span>  <span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu">ripserr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ripserr/man/vietoris_rips.html" class="external-link">vietoris_rips</a></span><span class="op">(</span><span class="va">pc</span>, dim <span class="op">=</span> <span class="fl">1</span>, threshold <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="reference/pl_new.html">pl_new</a></span><span class="op">(</span><span class="va">pd</span>, degree <span class="op">=</span> <span class="fl">1</span>, xby <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co"># samples of landscapes from circles</span></span>
<span><span class="va">pl2s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">8</span>, <span class="op">{</span></span>
<span>  <span class="va">pc</span> <span class="op">&lt;-</span> <span class="fu">tdaunif</span><span class="fu">::</span><span class="fu"><a href="https://tdaverse.github.io/tdaunif/reference/circles.html" class="external-link">sample_circle</a></span><span class="op">(</span><span class="fl">60</span>, sd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>  <span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu">ripserr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ripserr/man/vietoris_rips.html" class="external-link">vietoris_rips</a></span><span class="op">(</span><span class="va">pc</span>, dim <span class="op">=</span> <span class="fl">1</span>, threshold <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="reference/pl_new.html">pl_new</a></span><span class="op">(</span><span class="va">pd</span>, degree <span class="op">=</span> <span class="fl">1</span>, xby <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>An inspection of the mean landscapes makes clear that they are distinct:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># average landscape from each sample</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">1L</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/arithmetic.html">pl_mean</a></span><span class="op">(</span><span class="va">pl1s</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/arithmetic.html">pl_mean</a></span><span class="op">(</span><span class="va">pl2s</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-19-1.png"><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>However, the two hypothesis tests use different procedures and rely on different test statistics, so one may be more effective than another. For convenience, both methods return objects of class <code>'htest'</code> for convenient printing:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># z-test of difference in integrals of first level</span></span>
<span><span class="fu"><a href="reference/inference.html">pl_z_test</a></span><span class="op">(</span><span class="va">pl1s</span>, <span class="va">pl2s</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  z-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; z = -2.3584, df = 12, p-value = 0.01835</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.067781063 -0.006254089</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean integral of x mean integral of y </span></span>
<span><span class="co">#&gt;         0.02664640         0.06366397</span></span>
<span><span class="co"># permutation test of pairwise distances between landscapes</span></span>
<span><span class="fu"><a href="reference/inference.html">pl_perm_test</a></span><span class="op">(</span><span class="va">pl1s</span>, <span class="va">pl2s</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  permutation test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: true distance between mean landscapes is greater than 0</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; distance between mean landscapes </span></span>
<span><span class="co">#&gt;                       0.06631177</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<div class="section level3">
<h3 id="precursors">Precursors<a class="anchor" aria-label="anchor" href="#precursors"></a>
</h3>
<p>The C++ library is adapted from <a href="https://www2.math.upenn.edu/~dlotko/persistenceLandscape.html" class="external-link">Paweł Dłotko’s Persistence Landscape Toolbox</a>. It was originally adapted and ported to R in <a href="https://github.com/jjbouza/tda-tools" class="external-link">Jose Bouza’s <strong>tda-tools</strong> package</a>.</p>
</div>
<div class="section level3">
<h3 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h3>
<p>Development of this package benefitted from the use of equipment and the support of colleagues at the <a href="https://www.ufl.edu/" class="external-link">University of Florida</a>, especially <a href="https://people.clas.ufl.edu/peterbubenik/researchgroup/" class="external-link">Peter Bubenik’s research group</a> and the <a href="https://systemsmedicine.pulmonary.medicine.ufl.edu/" class="external-link">Laboratory for Systems Medicine</a>.</p>
</div>
<div class="section level3">
<h3 id="contribute">Contribute<a class="anchor" aria-label="anchor" href="#contribute"></a>
</h3>
<p>Bug reports, unit tests, documentation, use cases, feature suggestions, and other contributions are welcome. See the <a href="https://github.com/corybrunson/plt/blob/main/CONTRIBUTING.md" class="external-link">CONTRIBUTING</a> file for guidance, and please respect the <a href="https://github.com/corybrunson/plt/blob/main/CODE_OF_CONDUCT.md" class="external-link">Code of Conduct</a>.</p>
</div>
<div class="section level3">
<h3 id="cite">Cite<a class="anchor" aria-label="anchor" href="#cite"></a>
</h3>
<p>If you use <strong>plt</strong> in published work, please include a citation following <code>citation("plt")</code>.</p>
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Bubenik P (2015) “Statistical Topological Data Analysis using Persistence Landscapes”. <em>Journal of Machine Learning Research</em> <strong>16</strong>(3):77–102. <a href="https://jmlr.csail.mit.edu/papers/v16/bubenik15a.html" class="external-link uri">https://jmlr.csail.mit.edu/papers/v16/bubenik15a.html</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Bubenik P &amp; Dłotko P (2017) “A persistence landscapes toolbox for topological statistics”. <em>Journal of Symbolic Computation</em> <strong>78</strong>(1):91–114. <a href="https://www.sciencedirect.com/science/article/pii/S0747717116300104" class="external-link uri">https://www.sciencedirect.com/science/article/pii/S0747717116300104</a><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing plt</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jason Cory Brunson <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-3126-9494" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>James Golabek <br><small class="roles"> Author </small>  </li>
<li>Aidan Bryant <br><small class="roles"> Author </small>  </li>
<li>Jose Bouza <br><small class="roles"> Author, programmer, copyright holder </small>  </li>
<li>Paweł Dłotko <br><small class="roles"> Author, programmer, copyright holder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Jason Cory Brunson, James Golabek, Aidan Bryant, Jose Bouza, Paweł Dłotko.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
